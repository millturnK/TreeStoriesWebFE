
<div class="alert alert-success" role="alert" *ngIf="success" >
  <h4>Story Submitted</h4>
  <p>Thankyou. This story has now been submitted and will appear on the home-screen map.</p>
</div>

<div class="alert alert-danger" role="alert"  *ngIf="errorMessage">
  <div class="header">Failed to save story</div>
  <p>The following error occurred when trying to save your story: {{errorMessage}}</p>
</div>



<div class="row" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
  <div class="col-md-12">

    <h1><img src="../../assets/TreeStoriesTempLogo.png" height="100px" alt="Tree Stories logo">
      Edit your story</h1>


  </div>
</div>

<form role="form" (ngSubmit)="onSubmit(editStoryForm.value)" [formGroup]="editStoryForm">


  <div class="row">
    <div class="col-md-12">
      <div class="form-group">
        <label for="title">Title</label>
        <input id="title" name="title" class="form-control" formControlName="title"  rows="1" required>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-4">
      <div class="form-group">
        <label imgUpload="botName">Upload photo(s)</label>
        <image-upload id="imgUpload"[max]="5"
                      (onFileUploadFinish)="imageUploaded($event)"
                      [maxFileSize]="2048576">
        </image-upload>
      </div>
    </div>
  </div>
  <div *ngIf="editedStory">
  <div class="row">
    <div class="col-md-7">
      <app-map-displayonly [location]="editedStory.loc"></app-map-displayonly>
    </div>

    <div class="col-md-5">
      <img *ngFor="let uri of editedStory.photoLinks" src="{{uri}}" alt="tree image" style="width:75px;height:75px;margin:5px">
    </div>

  </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="form-group">
        <label for="ckMap">Location and type of feature</label>
        <div class="checkbox">
          <label><input type="checkbox" id="ckMap" formControlName="ckMap">Select in Map</label>
        </div>
        <label class="radio-inline"><input type="radio" id="coordChoiceSingle" formControlName="coordChoice" value="singleTree" >Single Tree</label>
        <label class="radio-inline"> <input type="radio" id="coordChoiceArea" formControlName="coordChoice" value="area">Region</label>

      </div>
    </div>
  </div>

  <!--<div class="row">-->
    <!--<div class="col-md-12" *ngIf="ckMap.value === true" height="500px">-->
      <!--<label>Select tree location below</label>-->
      <!--<p>Use the controls to zoom in and out then drag the marker to where your tree is. Or search for a place and click to add a marker.</p>-->

      <!--&lt;!&ndash;<app-google-maps [story]="storyModel" (onPositionChanged)="onPositionChanged($event)"></app-google-maps>&ndash;&gt;-->
      <!--<app-map (onPositionChanged)="onPositionChanged($event)" (onRectPositionChanged)="onRectPositionChanged($event)"></app-map>-->

    <!--</div>-->
  <!--</div>-->

  <div class="row">
    <div class="col-md-12">
      <div *ngIf="coordChoice.value === 'singleTree'">
        <div class="form-group">
          <div class="col-md-6">
            <label for="latitude"> Latitude</label>
            <input id="latitude" name="latitude" class="form-control" formControlName="latitude"
                   title="Latitudes must be in the format...." >
          </div>
        </div>
        <div class="form-group">
          <div class="col-md-6">
            <label for="longitude"> Longitude</label>
            <input id="longitude" name="longitude" class="form-control" formControlName="longitude"
                   title="Longitudes must be in the format...." >
          </div>
        </div>
      </div>
    </div>
  </div> <!-- end choice of single tree -->

  <div class="row">
    <div class="col-md-12">
      <div *ngIf="coordChoice.value === 'area'">
        <div class="form-group">
          <div class="col-md-6">
            <label for="bbPointsTopLeftLat"> Latitude: Top Left Corner Coords</label> <input id="bbPointsTopLeftLat" name="bbPointsTopLeftLat" class="form-control" formControlName="bbPointsTopLeftLat"
                                                                                             title="...must be in the format...." required>
          </div>
        </div>
        <div class="form-group">
          <div class="col-md-6">
            <label for="bbPointsTopLeftLng">  Longitude: Top Left Corner Coords </label><input id="bbPointsTopLeftLng" name="bbPointsTopLeftLng" class="form-control" formControlName="bbPointsTopLeftLng"
                                                                                               title="... must be in the format...." required>
          </div>
        </div>
        <div class="form-group">
          <div class="col-md-6">
            <label for="bbPointsBottomRightLat"> Latitude: Bottom Right Corner Coords </label> <input id="bbPointsBottomRightLat" name="bbPointsBottomRightLat" class="form-control" formControlName="bbPointsBottomRightLat"
                                                                                                      title="...must be in the format...." required>
          </div>
        </div>
        <div class="form-group">
          <div class="col-md-6">
            <label for="bbPointsBottomRightLng"> Longitude: Bottom Right Corner Coords </label><input id="bbPointsBottomRightLng" name="bbPointsBottomRightLng" class="form-control" formControlName="bbPointsBottomRightLng"
                                                                                                      title="... must be in the format...." required>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- end choice of area -->

  <div class="row">
    <div class="col-md-4">
      <div class="form-group">
        <label for="botName">Botanic name (if known)</label>
        <textarea id="botName" name="botName" class="form-control"
                  formControlName="botName"  rows="1"></textarea>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="form-group">
        <label for="description">Your tree story</label>
        <textarea id="description" name="description" class="form-control"
                  formControlName="description"  rows="3" required></textarea>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="form-group">
        <label for="source">Sources - where did your story come from?</label>
        <input type="text" id="source" name="source" class="form-control" formControlName="source" required >
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="form-group">
        <label for="contributor">Contributor</label>
        <input type="text" id="contributor" name="contributor" class="form-control" value="{{storyModel.contributors}}" formControlName="contributor" readonly>

      </div>
    </div>
  </div>
  <button type="submit" class="btn btn-success" [disabled]="!editStoryForm.valid">Submit</button>

</form>
<p>editlStoryForm value: {{ editStoryForm.value | json}}</p>
<p>editStoryModel value: {{ storyModel | json}}</p>
